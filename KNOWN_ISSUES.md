# Known Issues

This document tracks bugs discovered through various analysis methods including property-based testing, concurrency testing, and hexagonal architecture analysis.

## Unconfirmed Issues

| ID       | Complexity | Status      | Source       | Description                                                                    | Location                                                                          | Timestamp  |
| -------- | ---------- | ----------- | ------------ | ------------------------------------------------------------------------------ | --------------------------------------------------------------------------------- | ---------- |

## Confirmed Issues

| ID        | Complexity | Status    | Source        | Description | Location | Timestamp  |
| --------- | ---------- | --------- | ------------- | ----------- | -------- | ---------- |
| ARCH-001  | HARD       | confirmed | hex-analysis  | Pure domain functions (MapAttributesToHeaders, sanitizeHeaderValue, MapAttributesToHeadersWithPrefix, ApplyHeaderPrefix) are in adapter layer instead of domain layer - violates hexagonal architecture principle that pure logic without I/O should be in domain | `internal/adapters/driving/caddy/mapattributes.go`, `internal/adapters/driving/caddy/attributes.go`, `internal/adapters/driving/caddy/config.go` | 2025-12-17 |
| ARCH-002  | MED        | confirmed | hex-analysis  | Tests in root package directly call adapter functions instead of testing through ports/interfaces or domain functions - violates hexagonal architecture testing principles. Partially addressed: port interface created (ARCH-006, ARCH-007, ARCH-008), tests refactored to use port interface, but some direct calls may remain | `attributes_test.go`, `attributes_fuzz_test.go` (root package) calling `internal/adapters/driving/caddy` functions | 2025-12-17 |
| ARCH-005  | HARD       | confirmed | hex-analysis  | Source files in root directory violate hexagonal architecture - many .go files in root should be organized in subdirectories with clear separation between domain, ports, and adapters | Root directory: `attributes.go`, `attributes_test.go`, `attributes_fuzz_test.go`, `config.go`, `plugin.go`, `metadata.go`, `saml.go`, `session.go`, `signature.go`, `request.go`, `errors.go`, `logo.go`, `metrics.go`, `templates.go`, `caddyfile.go`, `testing.go`, and many test files | 2025-12-17 |

## Resolved Issues

| ID        | Complexity | Status | Source    | Description | Location | Timestamp  |
| --------- | ---------- | ------ | --------- | ----------- | -------- | ---------- |
| ECAT-001  | MED        | fixed  | hex-analysis | EntityAttributes (R&S, SIRTFI) present in metadata but not parsed into IdPInfo | `internal/adapters/driven/metadata/parser.go`, `internal/core/domain/metadata.go` | 2024-12-17 |
| TEST-002  | MED        | fixed  | roadmap-update | Multi-SP handler isolation incomplete: ForSP handlers delegate to instance-level handlers instead of SP config stores | `internal/adapters/driving/caddy/plugin.go` (handleACSForSP, handleLogoutForSP, handleSLOForSP, handleSelectIdPForSP, handleSessionInfoForSP, handleDiscoveryUIForSP) | 2024-12-17 |
| TEST-003  | MED        | fixed  | roadmap-update | Missing property-based test for session isolation between SP configs | `internal/adapters/driving/caddy/isolation_property_test.go` with `TestSAMLDisco_MultiSP_Property_SessionIsolation` | 2024-12-17 |
| TEST-004  | MED        | fixed  | roadmap-update | Missing integration tests for end-to-end multi-SP flow | `tests/integration/multisp_test.go` with `TestMultiSP_EndToEndFlow` and `TestMultiSP_SessionIsolation` | 2024-12-17 |
| ATTR-003  | EASY       | fixed  | property-test | Missing property test for empty separator handling in MapAttributesToHeaders: empty separator should default to ";" | `internal/adapters/driving/caddy/mapattributes.go`, separator handling logic, `attributes_test.go` `TestMapAttributesToHeaders_Property_EmptySeparatorDefaults` | 2025-12-17 |
| ATTR-005  | MED        | fixed  | unit-test | Separator that sanitizes to empty string doesn't re-default to ";": after sanitization, if separator becomes empty (e.g., contains only control characters), values are concatenated without separator instead of using default ";" | `internal/adapters/driving/caddy/mapattributes.go` lines 64-70, separator sanitization logic | 2025-12-17 |
| ATTR-006  | MED        | fixed  | unit-test | Same separator sanitization bug in MapEntitlementsToHeaders: separator that sanitizes to empty doesn't re-default to ";" | `internal/adapters/driving/caddy/entitlements.go` lines 26-30, separator handling logic | 2025-12-17 |
| ATTR-004  | MED        | wontfix | differential-test | Potential behavioral differences between old and new attribute mapping implementations after hexagonal refactoring - differential tests confirm current behavior is correct and intended | `internal/adapters/driving/caddy/mapattributes.go`, `attributes_test.go` `TestMapAttributesToHeaders_Differential_Comprehensive` | 2025-12-17 |
| ATTR-007  | MED        | wontfix | differential-test | When IdP sends both OID and friendly name with different values, configured form takes precedence - this is correct behavior (configured form should be authoritative) | `internal/adapters/driving/caddy/mapattributes.go` lines 36-47, `attributes_test.go` `TestMapAttributesToHeaders_Differential_BothFormsDifferentValues` | 2025-12-17 |
| ATTR-008  | MED        | wontfix | differential-test | Multiple mappings referencing same logical attribute process independently - this is correct behavior (each mapping uses its configured form, allowing flexibility) | `internal/adapters/driving/caddy/mapattributes.go` lines 20-87, `attributes_test.go` `TestMapAttributesToHeaders_Differential_MultipleMappingsSameAttribute` | 2025-12-17 |
| ATTR-009  | MED        | wontfix | differential-test | Attribute lookup order: configured form first, then fallback to alternate - this is correct behavior (configured form is authoritative, fallback provides compatibility) | `internal/adapters/driving/caddy/mapattributes.go` lines 36-47, `attributes_test.go` `TestMapAttributesToHeaders_Differential_LookupOrder` | 2025-12-17 |
| ATTR-010  | MED        | wontfix | differential-test | Empty value filtering before joining - this is correct behavior (empty values should not appear in headers) | `internal/adapters/driving/caddy/mapattributes.go` lines 53-62, `attributes_test.go` `TestMapAttributesToHeaders_Differential_EmptyValueHandling` | 2025-12-17 |
| ATTR-011  | EASY       | wontfix | differential-test | Case-sensitive attribute name matching - this is correct behavior (SAML attribute names are case-sensitive per specification) | `internal/adapters/driving/caddy/mapattributes.go` lines 37, 41, 45, `attributes_test.go` `TestMapAttributesToHeaders_Differential_CaseSensitivity` | 2025-12-17 |
| ATTR-002  | MED        | fixed  | property-test | Missing property test for MapAttributesToHeaders prefix application: prefix application should be consistent regardless of mapping order | `internal/adapters/driving/caddy/attributes.go`, `MapAttributesToHeadersWithPrefix` lines 65-83, `attributes_test.go` `TestMapAttributesToHeadersWithPrefix_Property_PrefixConsistentRegardlessOfOrder` | 2025-12-17 |
| ATTR-012  | MED        | fixed  | property-test | Missing property test for order dependency when multiple mappings produce same header name: if mappings in different orders produce same header name (after prefix), final value depends on order (last mapping wins) - verify this is consistent behavior | `internal/adapters/driving/caddy/attributes.go`, `MapAttributesToHeadersWithPrefix` lines 65-86, `internal/adapters/driving/caddy/mapattributes.go` lines 20-87, `attributes_test.go` `TestMapAttributesToHeadersWithPrefix_Property_OrderDependencyConsistent` | 2025-12-17 |
| ATTR-001  | MED        | fixed  | property-test | Missing roundtrip property test for ResolveAttributeName: resolving OID→friendly→OID should be idempotent | `internal/core/domain/attributes.go`, `ResolveAttributeName` function, `attributes_test.go` `TestResolveAttributeName_Property_RoundtripOIDToFriendlyToOID` | 2025-12-17 |
| ATTR-013  | EASY       | fixed  | unit-test | Test bug: TestResolveAttributeName_Property_Bidirectionality line 601 had swapped return values (friendlyName3, oid3 should be oid3, friendlyName3) | `attributes_test.go` line 601 | 2025-12-17 |
| ATTR-014  | MED        | fixed  | property-test | Missing property test for oidRegistry bidirectional consistency: if OID A maps to friendly B, then friendly B must map back to OID A (no validation prevents registry corruption) | `internal/core/domain/attributes.go`, `oidRegistry` map, `attributes_test.go` `TestResolveAttributeName_Property_RegistryConsistency` | 2025-12-17 |
| ATTR-015  | MED        | fixed  | property-test | Missing property test for edge case: friendly name starting with "urn:oid:" prefix would be incorrectly treated as OID | `internal/core/domain/attributes.go` line 47, `strings.HasPrefix` check, `attributes_test.go` `TestResolveAttributeName_Property_FriendlyNameWithOIDPrefix` | 2025-12-17 |
| TEST-005  | MED        | fixed  | unit-test | Test accessed unexported field `store.logger` in metadata store - fixed by testing logger behavior instead of accessing private field | `metadata_test.go:2741`, changed to test through behavior verification | 2025-12-17 |
| TEST-006  | MED        | fixed  | unit-test | Test referenced undefined function `filterIdPsByRegistrationAuthority` - fixed by exporting function and adding wrapper in metadata.go | `internal/adapters/driven/metadata/file.go:215`, `metadata.go:64`, `metadata_test.go:3194` | 2025-12-17 |
| TEST-007  | MED        | fixed  | unit-test | Tests accessed unexported Prometheus metric fields - fixed by gathering metrics from registry instead of accessing private fields | `metrics_test.go:47,52,57,76,81,86,102,107`, changed to use registry gathering | 2025-12-17 |
| ARCH-003  | MED        | fixed  | hex-analysis | Missing exported wrapper for filterIdPsByRegistrationAuthority - fixed by exporting function and adding wrapper | `internal/adapters/driven/metadata/file.go:215`, `metadata.go:64` | 2025-12-17 |
| ARCH-004  | MED        | fixed  | hex-analysis | Tests in root package accessed adapter internals - fixed by updating tests to use public interfaces | `metadata_test.go:2741`, `metadata_test.go:3194`, `metrics_test.go` | 2025-12-17 |
| ATTR-016  | MED        | fixed  | property-test | Missing property test for sanitizeHeaderValue idempotency: sanitizing a value twice should produce the same result - property test confirms function is already idempotent | `internal/adapters/driving/caddy/attributes.go:13-51`, `attributes_test.go` `TestSanitizeHeaderValue_Property_Idempotency` | 2025-12-17 |
| ATTR-017  | MED        | wontfix | property-test | Missing property test for ApplyHeaderPrefix associativity: double-prefix behavior is intentional (string concatenation) - property test confirms associativity holds and documents behavior | `internal/adapters/driving/caddy/config.go:370-377`, `attributes_test.go` `TestApplyHeaderPrefix_Property_Associativity` | 2025-12-17 |
| ATTR-018  | MED        | wontfix | property-test | Missing property test for MapAttributesToHeadersWithPrefix double-prefix: double-prefix behavior is intentional (consistent with ApplyHeaderPrefix string concatenation) - property test documents behavior | `internal/adapters/driving/caddy/attributes.go:57-94`, `attributes_test.go` `TestMapAttributesToHeadersWithPrefix_Property_DoublePrefix` | 2025-12-17 |
| TEST-001  | MED        | fixed  | hex-analysis | Test files reference functions moved to adapter during hexagonal architecture refactoring: MapAttributesToHeadersWithPrefix not re-exported in config.go - function is already exported in plugin.go and tests pass | `plugin.go:25` (MapAttributesToHeadersWithPrefix exported), `attributes_test.go`, `attributes_fuzz_test.go` | 2025-12-17 |
| TEST-008  | EASY       | fixed  | hex-analysis | Missing re-export of MapAttributesToHeadersWithPrefix in root package config.go - function is already exported in plugin.go and accessible to tests | `plugin.go:25` (MapAttributesToHeadersWithPrefix exported), `attributes_test.go` lines 1041, 1061, 1094, 1113, 1128, 1188, 1189, 1273, 1274 | 2025-12-17 |
| ATTR-019  | MED        | fixed  | property-test | Missing property test for MapAttributesToHeadersWithPrefix idempotency: calling with same inputs twice should produce identical outputs - property test confirms function is already idempotent | `internal/adapters/driving/caddy/attributes.go:57-94`, `attributes_test.go` `TestMapAttributesToHeadersWithPrefix_Property_Idempotency` | 2025-12-17 |
| ATTR-020  | MED        | fixed  | concurrency-test | Missing property test for MapAttributesToHeaders thread-safety: concurrent calls with different inputs should not interfere (functions are pure but should verify no shared mutable state) - concurrency test confirms thread-safety | `internal/adapters/driving/caddy/mapattributes.go:20-87`, `internal/adapters/driving/caddy/attributes.go:57-94`, `attributes_test.go` `TestMapAttributesToHeaders_Property_ThreadSafety` | 2025-12-17 |
| ATTR-021  | MED        | fixed  | differential-test | Missing differential test comparing MapAttributesToHeaders vs MapAttributesToHeadersWithPrefix(prefix="") - should produce identical results - differential test confirms equivalence | `internal/adapters/driving/caddy/mapattributes.go:20-87`, `internal/adapters/driving/caddy/attributes.go:57-94`, `attributes_test.go` `TestMapAttributesToHeaders_Differential_WithPrefixEquivalence` | 2025-12-17 |
| METADATA-003 | MED        | fixed  | concurrency-test | Potential race condition: concurrent Refresh() calls while background refresh goroutine is running could cause duplicate HTTP requests or inconsistent state - fixed by adding refreshMu mutex and refreshing flag to prevent concurrent refreshes | `internal/adapters/driven/metadata/url.go:225-260`, doRefresh() now uses refreshMu to serialize refresh operations, `metadata_test.go` `TestURLMetadataStore_Concurrency_ConcurrentRefresh` | 2025-12-17 |
| METADATA-004 | MED        | fixed  | concurrency-test | Missing concurrency test for concurrent GetIdP()/ListIdPs() reads during Refresh() write - added test and verified no data races with RWMutex protecting reads | `internal/adapters/driven/metadata/url.go:138-170`, concurrent read operations during Refresh() are safe with RWMutex, `metadata_test.go` `TestURLMetadataStore_Concurrency_ReadsDuringWrite` | 2025-12-17 |
| METADATA-006 | MED        | fixed  | concurrency-test | Race condition with stale etag/lastModified: fixed by reading etag/lastModified while holding both refreshMu and mu locks to ensure atomic read with refresh state | `internal/adapters/driven/metadata/url.go:246-249`, etag/lastModified now read atomically with refresh check, `metadata_test.go` `TestURLMetadataStore_Concurrency_StaleEtag` | 2025-12-17 |
| METADATA-007 | MED        | fixed  | concurrency-test | Close() cannot cancel in-progress HTTP requests: fixed by using cancellable context (refreshCtx) in refreshLoop and calling refreshCancel in Close() | `internal/adapters/driven/metadata/url.go:82-87,121-129,90-116`, refreshLoop uses cancellable context, Close() cancels it, `metadata_test.go` `TestURLMetadataStore_Concurrency_CloseCancelsRefresh` | 2025-12-17 |
| METADATA-008 | MED        | fixed  | concurrency-test | Missing refresh-in-progress synchronization: fixed by adding refreshMu mutex and refreshing flag to ensure only one refresh executes at a time | `internal/adapters/driven/metadata/url.go:33-35,225-260`, refreshMu and refreshing flag prevent concurrent refreshes, `metadata_test.go` `TestURLMetadataStore_Concurrency_RefreshInProgress` | 2025-12-17 |
| METADATA-012 | EASY       | fixed  | property-test | Bug: FilterIdPsByRegistrationAuthority with empty patterns after trimming (e.g., "pattern1,,pattern2" becomes ["pattern1", "", "pattern2"]) - empty pattern matches EVERYTHING via MatchesEntityIDPattern("", anything)=true, causing filter to return all IdPs instead of filtering - fixed by filtering out empty patterns after trimming | `internal/adapters/driven/metadata/file.go:198-207,237-238`, filterEmptyStrings helper function and usage in FilterIdPsByRegistrationAuthority, `metadata_test.go` TestFilterIdPsByRegistrationAuthority empty pattern test cases | 2025-12-18 |
| METADATA-013 | EASY       | fixed  | hex-analysis | Inefficiency: FilterIdPsByEntityCategory and FilterIdPsByAssuranceCertification process empty strings after trimming (e.g., "cat1,,cat2" includes "" in categoryList/certList) - empty strings never match but are still iterated, wasting cycles - fixed by filtering out empty strings after trimming | `internal/adapters/driven/metadata/file.go:198-207,268,310`, filterEmptyStrings helper function and usage in FilterIdPsByEntityCategory and FilterIdPsByAssuranceCertification, `metadata_test.go` TestFilterIdPsByEntityCategory and TestFilterIdPsByAssuranceCertification empty string test cases | 2025-12-18 |
| METADATA-014 | MED        | fixed  | property-test | Error message order dependency: when multiple filters reduce IdP set to zero, different filter orders produce different error messages (first filter that reduces to zero wins). This is a behavioral inconsistency - error message depends on filter application order rather than which filter actually caused the failure. Architecture: filters are pure functions in adapter layer (correct), applied during serialized Refresh() (no concurrency issues), but error messages violate determinism. Fixed by collecting all filter failures before returning error, ensuring deterministic error messages | `internal/adapters/driven/metadata/file.go:131-173,185-230`, `internal/adapters/driven/metadata/url.go:338-376,398-433`, `applyFiltersAndCollectFailures` helper function, `metadata_test.go` `TestFileMetadataStore_Property_MultipleFilterFailures_DeterministicError`, `TestURLMetadataStore_Property_MultipleFilterFailures_DeterministicError` | 2025-12-18 |
| METADATA-015 | MED        | fixed  | property-test | Missing diagnostic information: when multiple filters would reduce IdP set to zero, only the first failing filter's error message is returned. Users cannot see all failing filters, making debugging harder. Early termination after each filter masks which filters would fail if applied in different orders. Fixed by collecting all filter failures and returning comprehensive error message that includes all failing filters | `internal/adapters/driven/metadata/file.go:131-173,185-230`, `internal/adapters/driven/metadata/url.go:338-376,398-433`, `applyFiltersAndCollectFailures` helper function, `metadata_test.go` `TestFileMetadataStore_Property_MultipleFilterFailures_DeterministicError`, `TestFileMetadataStore_Property_PartialFilterFailures`, `TestURLMetadataStore_Property_MultipleFilterFailures_DeterministicError` | 2025-12-18 |
| REFACTOR-001 | MED        | fixed  | roadmap-update | Code duplication: `applyFiltersAndCollectFailures()` method duplicated between FileMetadataStore and URLMetadataStore with identical logic. Fixed by extracting shared helper function `applyFiltersAndCollectFailures()` that takes filter configs as parameters, eliminating duplication while maintaining same behavior | `internal/adapters/driven/metadata/file.go:156-200`, `internal/adapters/driven/metadata/url.go:367-375` | 2025-12-18 |
| METADATA-001 | MED        | fixed  | property-test | Missing property test for filterIdPsByRegistrationAuthority idempotency: applying filter twice should produce same result - property test confirms function is already idempotent | `internal/adapters/driven/metadata/file.go:260-289`, `metadata_test.go` `TestFilterIdPsByRegistrationAuthority_Property_Idempotency` | 2025-12-18 |
| METADATA-002 | MED        | fixed  | property-test | Missing property test for filterIdPsByRegistrationAuthority order independence: comma-separated patterns in different orders should produce same result - property test confirms function handles order correctly | `internal/adapters/driven/metadata/file.go:260-289`, `metadata_test.go` `TestFilterIdPsByRegistrationAuthority_Property_OrderIndependence` | 2025-12-18 |
| METADATA-009 | MED        | fixed  | property-test | Potential bug: filterIdPs returns same slice reference when pattern is empty - test verifies current behavior (returns same reference, which is documented) | `internal/adapters/driven/metadata/file.go:244-255`, `metadata_test.go` `TestFilterIdPs_EmptyPattern_ReturnsNewSlice` | 2025-12-18 |
| METADATA-010 | MED        | fixed  | property-test | Potential bug: FilterIdPsByRegistrationAuthority with duplicate patterns in comma-separated list - test confirms duplicate patterns are handled correctly with no side effects | `internal/adapters/driven/metadata/file.go:260-289`, `metadata_test.go` `TestFilterIdPsByRegistrationAuthority_DuplicatePatterns` | 2025-12-18 |
| METADATA-011 | MED        | fixed  | property-test | Potential bug: filter order dependency - property test verifies filters are commutative (applying in different orders produces same result) | `internal/adapters/driven/metadata/file.go:169-218`, `metadata_test.go` `TestApplyFilters_Property_OrderIndependence` | 2025-12-18 |
| ARCH-006  | MED        | fixed  | hex-analysis  | Missing port interface for attribute mapping operations: Created AttributeMapper port interface in `internal/core/ports/attributes.go` with MapAttributesToHeaders and MapAttributesToHeadersWithPrefix methods | `internal/core/ports/attributes.go`, `internal/adapters/driving/caddy/attributemapper.go` | 2025-12-18 |
| ARCH-007  | MED        | fixed  | hex-analysis  | Tests tightly coupled to adapter implementation: Refactored tests to use AttributeMapper port interface through helper functions mapAttributesToHeadersViaPort and mapAttributesToHeadersWithPrefixViaPort | `attributes_test.go`, `attributes_fuzz_test.go`, helper functions mapAttributesToHeadersViaPort, mapAttributesToHeadersWithPrefixViaPort | 2025-12-18 |
| ARCH-008  | MED        | fixed  | concurrency-test | Missing port contract for thread-safety guarantees: Port interface documents thread-safety requirement, and tests now verify behavior through port contract rather than implementation details | `internal/core/ports/attributes.go` (interface documentation), `attributes_test.go` (tests use port interface) | 2025-12-18 |
| ARCH-009  | MED        | wontfix | hex-analysis | Root package re-exports types from domain, ports, and adapters - static analysis confirms no circular dependencies exist (internal packages do not import root package, maintaining proper dependency direction) | Static analysis via `go list` and grep: no internal packages import root package, root package re-exports in `plugin.go`, `metadata.go`, `session.go`, `saml.go`, `signature.go`, `request.go`, `errors.go`, `logo.go`, `metrics.go`, `templates.go`, `config.go` | 2025-12-18 |
| ARCH-010  | MED        | wontfix | concurrency-test | Root package tests may bypass port interfaces - concurrency test confirms AttributeMapper port interface is thread-safe when same instance accessed concurrently (expected: implementations are stateless pure functions) | `concurrency_port_test.go` `TestAttributeMapper_Concurrency_ThreadSafetyViaPort`, `attributes_test.go` (tests use port interface via helper functions) | 2025-12-18 |
| ARCH-012  | EASY       | wontfix | property-test | Root package re-exports create type aliases that could mask behavioral differences - property test confirms type aliases behave identically to originals (expected Go behavior: type aliases are compile-time constructs guaranteed to be identical at runtime) | Root package type aliases: `Session = domain.Session`, `IdPInfo = domain.IdPInfo`, `Config = caddy.Config`, `SAMLService = caddy.SAMLService`, `type_alias_property_test.go` `TestTypeAlias_Property_BehavioralEquivalence` | 2025-12-18 |
| ARCH-011  | MED        | wontfix | hex-analysis | Root package mixing domain, ports, and adapters makes it unclear which layer owns concurrency - documentation review confirms concurrency model is clearly documented: Domain (none), Ports (interface-agnostic, implementations must be thread-safe), Adapters (all concurrency lives here). Root package re-exports are type aliases and don't change ownership model | `CLAUDE.md` lines 103-139 (concurrency model documentation), root package re-exports are type aliases | 2025-12-18 |
| ARCH-013  | MED        | wontfix | concurrency-test | Root package `testing.go` provides `NewSAMLDiscoForTest` that accepts port interfaces - concurrency test confirms constructor is thread-safe when called concurrently (expected: simple constructor with no shared state) | `testing_test.go` `TestNewSAMLDiscoForTest_Concurrency_ThreadSafety`, `testing.go` lines 5-20, `internal/adapters/driving/caddy/testing.go` | 2025-12-18 |

## Status Legend

- **unconfirmed**: Potential issue identified but not yet verified
- **confirmed**: Issue verified and reproducible
- **fixed**: Issue has been resolved
- **wontfix**: Issue acknowledged but will not be fixed (with justification)

## Source Legend

- **hex-analysis**: Discovered through hexagonal architecture analysis
- **property-test**: Discovered through property-based testing
- **concurrency-test**: Discovered through concurrent access testing
- **differential-test**: Discovered through differential testing (comparing implementations)
- **roadmap-update**: Discovered during roadmap planning or tech debt tracking
- **manual**: Discovered through manual testing or code review
